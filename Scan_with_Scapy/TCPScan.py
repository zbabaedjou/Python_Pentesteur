import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
from scapy.all import *

SYN= IP(dst="192.168.1.47")/TCP(dport=80,flags='S')
print  "Envoye"
SYN.display()

print  "Response"
response = sr1(SYN, timeout=1, verbose=0)
response.display()
#si le flag dans la reponse est un SYN.ACK alors  le port est ouvert
#dans le cas ou on a un RA cad RST.ACK alors le port est ferme.
if int(response[TCP].flags)==18:
    print "Envoye"
    ACK= IP(dst="192.168.1.47")/TCP(dport=80, flags='A',ack=(response[TCP].seq+1))
    response2=sr1(ACK, timeout=1, verbose=0)
    ACK.display()
    print "Reponse"
    response2.display()
else :
    print "Pas de SYN.ACK donc le port est ferm√©"