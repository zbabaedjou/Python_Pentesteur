from scapy.all import *

#savoir si le symteme de filtrage d'un port est active
# avoir de ACK si response TCP.RST port non filtrer sinon pas filtrer

response, no_response= sr(IP(dst="192.168.1.47")/TCP(dport=[80,21], flags="A"))

for s,r in response:
    if s[TCP].dport==s[TCP].sport:
        print " Port non filtrer : ", s[TCP].dport

    else:
        print  "Port non filtre", s[TCP].dport