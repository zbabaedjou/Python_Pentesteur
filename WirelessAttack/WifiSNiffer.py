from scapy.all import *

ap_list=[]
iface="wlan0mon"
#cette fonction filtre les paquets
def parsePacker(pkt):
    #si le packet est en relation avec le wifi
    if pkt.haslayer(Dot11):
        #filtrer les packets de gestion (beacon frame) qui comporte les information sur le reseau
        #0 relatif au trame de gestion et 8 au sous type des trames de type beacome qui contiennent les infos sur le reseaus
        if pkt.type==0 and pkt.subtype==8:
            #verifier si le SSID n'existe pas encore dans la liste actuelle
            if pkt.addr2 not in ap_list:
                print pkt.show()
                ap_list.append(pkt.addr2)
                print "BSSID: %s ------ SSID : s% "%(pkt.addr2, pkt.info) # affiche l'addresse MAC puis le SSID de chaque ROUTEURS

while 1: #permet de faire le sniffing en temps reelle
    sniff(iface=iface, prn=parsePacker, count=10,timeout=3)

