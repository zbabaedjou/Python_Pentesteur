import sys
from scapy.all import *

if len(sys.argv) != 2:
    print" Utilisation : python ARPScanner.py 192.168.1.0/24"
    sys.exit(1)  # rexuperer les paramettre
try:
    # scann le reseau on envoie a toutes les machines du reseau des requetes APR pour avoir l'@MAC des machines specifie avec le pdst
    # srp envoie Packet au niveau de la coucheh 2 avec packet avec ou sans reponse
    # dst destinataire(a qui on demande)
    # pdst: adresse de la machine dont on veut avoir l'@ MAC C.a.d. enssembe du sous reseau
    response, no_response = srp(Ether(dst="ff:ff:ff:ff:ff:ff") / ARP(pdst=sys.argv[1]), timeout=2, verbose=0)
    print "Adresse MAC - Adress IP"
    for i in range(0, len(response)):  # pour toutes les reponses
        # hwsrc @ MAC source repondu
        # psrc@IP source
        print response[i][1].hwsrc + "--" + response[i][1].psrc
except:
    pass

# lancer en mettant en paramettre l'addres a scanner avec le masque
